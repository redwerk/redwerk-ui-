{"version":3,"file":"RwCarousel.16b3b6b8.js","sources":["../../src/components/RwCarousel/useAutoplay.ts","../../src/components/RwCarousel/useScroll.ts","../../src/components/RwCarousel/useSlideIntersection.ts","../../src/components/RwCarousel/useMouseEvents.ts","../../src/components/RwCarousel/RwCarousel.vue"],"sourcesContent":["import { ref } from 'vue';\nimport type { RwCarouselAutoplayOptions, RwCarouselProps } from './types';\n\ntype SetInterval = ReturnType<typeof setInterval>;\n\nconst DEFAULT_OPTIONS: RwCarouselAutoplayOptions = {\n  pauseOnHover: true,\n  delay: 5000,\n};\n\ninterface Params {\n  props: RwCarouselProps,\n  nextSlideFn: () => void,\n  prevSlideFn: () => void,\n}\nexport function useAutoplay(params: Params) {\n  // TODO: implement autoplay\n\n  const changeInterval = ref<SetInterval>();\n\n  const currentIntervalTime = ref(0);\n\n  function getOptions() {\n    const options: RwCarouselAutoplayOptions = { ...DEFAULT_OPTIONS };\n\n    if (typeof params.props.autoplay === 'object') {\n      options.delay = params.props.autoplay.delay ?? options.delay;\n      options.pauseOnHover = params.props.autoplay.pauseOnHover ?? options.pauseOnHover;\n    }\n\n    return options;\n  }\n\n  function startAutoplay() {\n    if (!params.props.autoplay) {\n      return;\n    }\n\n    const options = getOptions();\n\n    changeInterval.value = setInterval(() => {}, options.delay);\n  }\n\n  function stopAutoplay() {\n    if (changeInterval.value) {\n      clearInterval(changeInterval.value);\n    }\n\n    changeInterval.value = undefined;\n  }\n\n  return {\n    startAutoplay,\n    stopAutoplay,\n  };\n}\n","import { nextTick, ref } from 'vue';\nimport type { Ref, ComputedRef } from 'vue';\nimport { useDebounceFn } from '@vueuse/core';\n\nimport type { RwCarouselProps } from './types';\n\ninterface Data {\n  scrollerElementRef: Ref<HTMLDivElement | undefined>,\n  props: RwCarouselProps,\n  itemElementWidth: ComputedRef<number>,\n  slidesKeys: Ref<string[]>,\n}\n\ninterface ScrollToData {\n  offsetWidth: number,\n  scrollPosition: number,\n  contentWidth: number,\n}\n\nexport function useScroll({\n  scrollerElementRef, props, itemElementWidth, slidesKeys,\n}: Data) {\n  // TODO: fix infinite scrolling\n  const firstVisibleSlideKey = ref('');\n  const visibleSlidesKeys = ref<string[]>([]);\n  const isScrollEnd = ref(false);\n  const prevScrollPosition = ref(0);\n  const isProgramScroll = ref(false);\n\n  const mockSlides = ref(new Array(slidesKeys.value.length));\n  const visibleMockSlidesKeys = ref<string[]>([]);\n\n  function setOverflow(value: string) {\n    if (!scrollerElementRef.value) {\n      return;\n    }\n\n    if (props.vertical) {\n      scrollerElementRef.value.style.overflowY = value;\n    } else {\n      scrollerElementRef.value.style.overflowX = value;\n    }\n  }\n\n  function scrollToSlideByKey(slideKey: string) {\n    if (!scrollerElementRef.value) {\n      return;\n    }\n\n    isProgramScroll.value = true;\n\n    const slideElement = scrollerElementRef.value.querySelector(`.rw-carousel-item[data-slide='${slideKey}']`);\n\n    slideElement?.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });\n\n    setTimeout(() => {\n      isProgramScroll.value = false;\n    }, 1000);\n  }\n\n  function detectVisibleMockSlides() {\n    if (!scrollerElementRef.value) {\n      return;\n    }\n\n    const slideElements = [...scrollerElementRef.value.querySelectorAll<HTMLElement>('.rw-carousel-item-mock[data-visible=\"true\"]')];\n\n    visibleMockSlidesKeys.value = slideElements.map((slideElement) => slideElement.dataset.slide as string);\n  }\n\n  function detectVisibleSlides() {\n    if (!scrollerElementRef.value) {\n      return;\n    }\n\n    const slideElements = [...scrollerElementRef.value.querySelectorAll<HTMLElement>('.rw-carousel-item[data-visible=\"true\"]')];\n\n    visibleSlidesKeys.value = slideElements.map((slideElement) => slideElement.dataset.slide as string);\n\n    mockSlides.value = new Array(Math.ceil(visibleSlidesKeys.value.length / 2));\n  }\n\n  const detectFirstVisibleSlide = useDebounceFn(() => {\n    if (!scrollerElementRef.value) {\n      return;\n    }\n\n    detectVisibleSlides();\n    detectVisibleMockSlides();\n\n    const middleIndex = Math.floor((visibleSlidesKeys.value.length - 1) / 2);\n\n    const isFirstSlideVisible = visibleSlidesKeys.value.length && slidesKeys.value[0] === visibleSlidesKeys.value[0];\n    const isLastSlideVisible = visibleSlidesKeys.value.length && slidesKeys.value[slidesKeys.value.length - 1] === visibleSlidesKeys.value[visibleSlidesKeys.value.length - 1];\n\n    const mockSlidesVisible = mockSlides.value.length === visibleMockSlidesKeys.value.length;\n\n    let slideKey = '';\n\n    if (isFirstSlideVisible && mockSlidesVisible) {\n      slideKey = slidesKeys.value[0];\n    } else if (isLastSlideVisible && mockSlidesVisible) {\n      slideKey = slidesKeys.value[slidesKeys.value.length - 1];\n    } else {\n      slideKey = visibleSlidesKeys.value[middleIndex] || '';\n    }\n\n    firstVisibleSlideKey.value = slideKey || '';\n\n    // firstVisibleSlideKey.value = visibleSlidesKeys.value[middleIndex] || '';\n  }, 200);\n\n  function scrollTo(top: number, left: number) {\n    if (!scrollerElementRef.value) {\n      return;\n    }\n\n    setOverflow('hidden');\n    scrollerElementRef.value.style.scrollBehavior = 'auto';\n\n    scrollerElementRef.value.scroll({\n      top, left,\n    });\n\n    setTimeout(() => {\n      if (scrollerElementRef.value) {\n        setOverflow('auto');\n        scrollerElementRef.value.style.scrollBehavior = 'smooth';\n      }\n    }, 10);\n  }\n\n  async function scroll(data: ScrollToData) {\n    if (!scrollerElementRef.value) {\n      return;\n    }\n\n    const width = data.offsetWidth + data.scrollPosition;\n\n    const endWidth = data.contentWidth - itemElementWidth.value;\n\n    isScrollEnd.value = width >= endWidth;\n\n    if (props.infinite && isScrollEnd.value) {\n      scrollerElementRef.value.style.scrollBehavior = 'auto';\n    }\n\n    await nextTick();\n\n    if (!isProgramScroll.value && props.infinite && !data.scrollPosition) {\n      const top = props.vertical\n        ? data.contentWidth - data.offsetWidth - 50\n        : 0;\n\n      const left = props.vertical\n        ? 0\n        : data.contentWidth - data.offsetWidth - itemElementWidth.value;\n\n      scrollTo(top, left);\n    } else if (!isProgramScroll.value && props.infinite && width >= data.contentWidth && width > prevScrollPosition.value) {\n      scrollTo(10, 10);\n    }\n\n    prevScrollPosition.value = data.scrollPosition;\n  }\n\n  async function onScrollEvent() {\n    if (!scrollerElementRef.value) {\n      return;\n    }\n\n    const data = props.vertical ? {\n      offsetWidth: scrollerElementRef.value.offsetHeight,\n      scrollPosition: scrollerElementRef.value.scrollTop,\n      contentWidth: scrollerElementRef.value.scrollHeight,\n    } : {\n      offsetWidth: scrollerElementRef.value.offsetWidth,\n      scrollPosition: scrollerElementRef.value.scrollLeft,\n      contentWidth: scrollerElementRef.value.scrollWidth,\n    };\n\n    await scroll(data);\n\n    detectFirstVisibleSlide();\n  }\n\n  return {\n    onScrollEvent, scrollToSlideByKey, firstVisibleSlideKey, visibleSlidesKeys, detectFirstVisibleSlide, mockSlides, visibleMockSlidesKeys,\n  };\n}\n","import { ref } from 'vue';\nimport type { Ref } from 'vue';\nimport { useIntersectionObserver } from '@vueuse/core';\nimport type { RwCarouselProps } from './types';\n\ninterface Data {\n  props: RwCarouselProps,\n  scrollerElementRef: Ref<HTMLDivElement | undefined>\n}\n\nexport function useLastSlideIntersection({ scrollerElementRef, props }: Data) {\n  const copiedFirstRef = ref<HTMLDivElement>();\n\n  const copiedFirstRefIntersection = ref();\n\n  function registerRef(instance: HTMLDivElement) {\n    copiedFirstRef.value = instance;\n  }\n\n  function startIntersection() {\n    if (copiedFirstRefIntersection.value) {\n      copiedFirstRefIntersection.value.stop();\n    }\n\n    if (props.infinite) {\n      copiedFirstRefIntersection.value = useIntersectionObserver(\n        copiedFirstRef,\n        ([{ isIntersecting }]) => {\n          if (!isIntersecting || !scrollerElementRef.value) {\n            return;\n          }\n\n          const slides = scrollerElementRef.value.querySelectorAll('.rw-carousel-item');\n\n          if (copiedFirstRef.value) {\n            copiedFirstRef.value.innerHTML = slides[0].innerHTML;\n            copiedFirstRef.value.classList.remove(...copiedFirstRef.value.classList);\n            copiedFirstRef.value.classList.add(...slides[0].classList);\n          }\n        },\n      );\n    }\n  }\n\n  function stopIntersection() {\n    if (copiedFirstRefIntersection.value) {\n      copiedFirstRefIntersection.value.stop();\n    }\n    copiedFirstRefIntersection.value = undefined;\n  }\n\n  return {\n    startIntersection,\n    registerRef,\n    stopIntersection,\n  };\n}\n","import type { Ref } from 'vue';\nimport { reactive, ref } from 'vue';\nimport type { RwCarouselProps } from './types';\n\ninterface Params {\n  props: RwCarouselProps,\n  scrollerElementRef: Ref<HTMLDivElement | undefined>,\n}\n\nexport function useMouseEvents({ scrollerElementRef, props }: Params) {\n  const currentPosition = reactive({\n    top: 0, left: 0, x: 0, y: 0,\n  });\n\n  const isFocused = ref(false);\n\n  function onMouseMove(event: MouseEvent) {\n    if (!props.scrollByDrag || !isFocused.value || !scrollerElementRef.value) {\n      return;\n    }\n\n    // How far the mouse has been moved\n    const dx = event.clientX - currentPosition.x;\n    const dy = event.clientY - currentPosition.y;\n\n    // Scroll the element\n    scrollerElementRef.value.scrollTop = currentPosition.top - dy;\n    scrollerElementRef.value.scrollLeft = currentPosition.left - dx;\n  }\n\n  function onMouseUp() {\n    if (!props.scrollByDrag || !scrollerElementRef.value) {\n      return;\n    }\n\n    scrollerElementRef.value.style.cursor = 'grab';\n    scrollerElementRef.value.style.removeProperty('user-select');\n\n    scrollerElementRef.value.style.scrollSnapType = props.vertical ? 'y mandatory' : 'x mandatory';\n    scrollerElementRef.value.style.scrollBehavior = 'smooth';\n\n    isFocused.value = false;\n  }\n\n  function onMouseDown(event: MouseEvent) {\n    if (!props.scrollByDrag || !scrollerElementRef.value) {\n      return;\n    }\n\n    currentPosition.left = scrollerElementRef.value.scrollLeft;\n    currentPosition.top = scrollerElementRef.value.scrollTop;\n    currentPosition.x = event.clientX;\n    currentPosition.y = event.clientY;\n\n    scrollerElementRef.value.style.cursor = 'grabbing';\n    scrollerElementRef.value.style.userSelect = 'none';\n\n    scrollerElementRef.value.style.scrollSnapType = 'none';\n    scrollerElementRef.value.style.scrollBehavior = 'auto';\n\n    isFocused.value = true;\n  }\n\n  return { onMouseMove, onMouseUp, onMouseDown };\n}\n","<script setup lang=\"ts\">\nimport {\n  computed, onBeforeUnmount, onMounted, ref, useSlots,\n} from 'vue';\n\nimport RwCarouselItemMock from './RwCarouselItemMock.vue';\nimport { useAutoplay } from './useAutoplay';\nimport { RwIcon } from '../index';\n\nimport { useScroll } from './useScroll';\nimport { useLastSlideIntersection } from './useSlideIntersection';\nimport type { RwCarouselAutoplayOptions, RwCarouselSlots } from './types';\nimport { useMouseEvents } from './useMouseEvents';\n\nconst props = withDefaults(defineProps<{\n  vertical?: boolean,\n  infinite?: boolean,\n  showScroll?: boolean,\n  autoplay?: boolean | RwCarouselAutoplayOptions,\n  maxVisible?: number,\n  notVisibleOffset?: string,\n  showDots?: boolean,\n  showButtons?: boolean,\n  scrollByDrag?: boolean,\n  showMockSlides?: boolean,\n}>(), {\n  vertical: false,\n  infinite: false,\n  showScroll: false,\n  autoplay: false,\n  maxVisible: undefined,\n  notVisibleOffset: undefined,\n  showDots: true,\n  showButtons: true,\n  scrollByDrag: true,\n  showMockSlides: false,\n});\n\nconst scrollerElementRef = ref<HTMLDivElement>();\n\nconst itemElementWidth = computed(() => {\n  if (typeof window === 'undefined' || !scrollerElementRef.value) {\n    return 0;\n  }\n\n  const width = props.vertical\n    ? scrollerElementRef.value.querySelector('.rw-carousel-item')?.clientHeight\n    : scrollerElementRef.value.querySelector('.rw-carousel-item')?.clientWidth;\n\n  return width || 0;\n});\n\nconst slots = useSlots() as unknown as RwCarouselSlots;\n\nconst slidesKeys = computed(() => {\n  const nodes = slots?.default({ activeItemIndex: 0 }) || [];\n\n  if (!nodes.length) {\n    return [];\n  }\n\n  const nodeWithSlides = nodes[0].children as any[] || [];\n\n  return nodeWithSlides.map((child) => `slide-${child.key}`);\n});\n\nconst slideStyles = computed(() => {\n  if (props.vertical) {\n    return {\n      height: `${itemElementWidth.value}px`,\n    };\n  }\n\n  return {\n    width: `${itemElementWidth.value}px`,\n  };\n});\n\nconst carouselScroll = useScroll({\n  props,\n  itemElementWidth,\n  scrollerElementRef,\n  slidesKeys,\n});\n\nconst activeItemIndex = computed(() => slidesKeys.value.findIndex((key) => carouselScroll.firstVisibleSlideKey.value === key));\n\nconst lastSlide = useLastSlideIntersection({ props, scrollerElementRef });\n\nfunction next() {\n  const offset = carouselScroll.visibleSlidesKeys.value.length === 1\n    ? itemElementWidth.value + (itemElementWidth.value / 3)\n    : itemElementWidth.value;\n\n  if (props.vertical) {\n    scrollerElementRef.value?.scrollBy(0, offset);\n  } else {\n    scrollerElementRef.value?.scrollBy(offset, 0);\n  }\n}\n\nfunction previous() {\n  const offset = carouselScroll.visibleSlidesKeys.value.length === 1\n    ? itemElementWidth.value + (itemElementWidth.value / 3)\n    : itemElementWidth.value;\n\n  if (props.vertical) {\n    scrollerElementRef.value?.scrollBy(0, -offset);\n  } else {\n    scrollerElementRef.value?.scrollBy(-offset, 0);\n  }\n}\n\nconst autoplay = useAutoplay({\n  props,\n  nextSlideFn: next,\n  prevSlideFn: previous,\n});\n\nconst mouseEvents = useMouseEvents({ props, scrollerElementRef });\n\nconst scrollerStyle = computed(() => {\n  const offset = props.notVisibleOffset || '0px';\n  const gridStyle = props.maxVisible ? `calc((100% / ${props.maxVisible}) - ${offset})` : 'auto';\n  const cursor = props.scrollByDrag ? 'grab' : 'auto';\n\n  if (props.vertical) {\n    return {\n      width: '100%',\n      gridAutoRows: gridStyle,\n      cursor,\n    };\n  }\n\n  return {\n    gridAutoColumns: gridStyle,\n    cursor,\n  };\n});\n\nonMounted(() => {\n  autoplay.startAutoplay();\n\n  scrollerElementRef.value?.addEventListener('scroll', carouselScroll.onScrollEvent);\n\n  carouselScroll.detectFirstVisibleSlide();\n\n  lastSlide.startIntersection();\n});\n\nonBeforeUnmount(() => {\n  autoplay.stopAutoplay();\n\n  scrollerElementRef.value?.removeEventListener('scroll', carouselScroll.onScrollEvent);\n\n  lastSlide.stopIntersection();\n});\n\ndefineExpose({ next, previous });\n</script>\n\n<template>\n  <div\n    :class=\"[\n      'rw-carousel',\n      {\n        vertical,\n        'hide-scrollbar': !showScroll,\n      },\n    ]\"\n  >\n    <div class=\"rw-carousel__container\">\n      <div\n        class=\"scroller\"\n        :style=\"scrollerStyle\"\n        ref=\"scrollerElementRef\"\n        @mousemove=\"mouseEvents.onMouseMove\"\n        @mouseup=\"mouseEvents.onMouseUp\"\n        @mousedown=\"mouseEvents.onMouseDown\"\n        @mouseout=\"mouseEvents.onMouseUp\"\n      >\n        <template v-if=\"showMockSlides\">\n          <RwCarouselItemMock\n            v-for=\"(_, index) in carouselScroll.mockSlides.value\"\n            :key=\"index\"\n            :style=\"slideStyles\"\n          />\n        </template>\n\n        <slot :active-item-index=\"activeItemIndex\" />\n\n        <div\n          v-if=\"infinite && carouselScroll.visibleSlidesKeys.value.length > 1\"\n          class=\"rw-carousel-item\"\n          :ref=\"lastSlide.registerRef\"\n        />\n\n        <template v-if=\"showMockSlides\">\n          <RwCarouselItemMock\n            v-for=\"(_, index) in carouselScroll.mockSlides.value\"\n            :key=\"index\"\n            :style=\"slideStyles\"\n          />\n        </template>\n      </div>\n\n      <template v-if=\"showButtons\">\n        <div class=\"btn prev\">\n          <slot\n            name=\"prevButtonSlot\"\n            :click=\"previous\"\n          >\n            <button\n              type=\"button\"\n              title=\"Previous slide\"\n              @click=\"previous\"\n            >\n              <RwIcon name=\"mdi:chevron-left\" />\n            </button>\n          </slot>\n        </div>\n\n        <div class=\"btn next\">\n          <slot\n            name=\"nextButtonSlot\"\n            :click=\"next\"\n          >\n            <button\n              type=\"button\"\n              title=\"Next slide\"\n              @click=\"next\"\n            >\n              <RwIcon name=\"mdi:chevron-right\" />\n            </button>\n          </slot>\n        </div>\n      </template>\n    </div>\n\n    <div class=\"rw-carousel__bottom\">\n      <slot\n        name=\"bottomSlot\"\n        :previous=\"previous\"\n        :next=\"next\"\n        :scroll-to=\"carouselScroll.scrollToSlideByKey\"\n        :slides-keys=\"slidesKeys\"\n        :active-slide-key=\"carouselScroll.firstVisibleSlideKey.value\"\n      >\n        <div\n          v-if=\"showDots\"\n          class=\"dots\"\n        >\n          <template\n            v-for=\"(key, index) in slidesKeys\"\n            :key=\"key\"\n          >\n            <slot\n              name=\"dotSlot\"\n              :slide-number=\"index + 1\"\n              :slide-key=\"key\"\n              :click=\"() => carouselScroll.scrollToSlideByKey(key)\"\n              :active=\"key === carouselScroll.firstVisibleSlideKey.value\"\n            >\n              <button\n                :class=\"[\n                  'dots__item',\n                  {\n                    active: key === carouselScroll.firstVisibleSlideKey.value,\n                  },\n                ]\"\n                type=\"button\"\n                :title=\"`Slide #${index + 1}`\"\n                @click=\"carouselScroll.scrollToSlideByKey(key)\"\n              />\n            </slot>\n          </template>\n        </div>\n      </slot>\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\">\n.rw-carousel {\n  &__container {\n    position: relative;\n\n    .scroller {\n      /* snap mandatory on horizontal axis  */\n      scroll-snap-type: x mandatory;\n      scroll-behavior: smooth;\n      scroll-padding: 100px;\n\n      overflow-x: auto;\n      overflow-y: hidden;\n\n      display: grid;\n      grid-auto-flow: column;\n\n      /* Enable Safari touch scrolling physics */\n      -webkit-overflow-scrolling: touch;\n\n      padding-bottom: 10px;\n\n      .rw-carousel-item {\n        /* snap align center  */\n        scroll-snap-align: center;\n        scroll-snap-stop: always;\n        position: relative;\n\n        &:first-of-type {\n          scroll-snap-align: start;\n        }\n\n        &:last-of-type {\n          scroll-snap-align: end;\n        }\n      }\n    }\n\n    .btn {\n      position: absolute;\n\n      top: 50%;\n      transform: translateY(-50%);\n\n      border-radius: 2px;\n      background-color: rgba(0,0,0,0.5);\n      background-position: 50% 50%;\n      background-repeat: no-repeat;\n\n      z-index: 1;\n\n      &.prev {\n        left: 10px;\n      }\n\n      &.next {\n        right: 10px;\n      }\n    }\n  }\n\n  &__bottom {\n    margin-top: 10px;\n\n    .dots {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      gap: 10px;\n      flex-wrap: wrap;\n\n      &__item {\n        cursor: pointer;\n        width: 20px;\n        height: 20px;\n        border: none;\n        border-radius: 50%;\n        background: lightgray;\n\n        &.active {\n          background: lightgreen;\n        }\n      }\n    }\n  }\n\n  &.vertical {\n    .scroller {\n      scroll-snap-type: y mandatory;\n      overflow-x: hidden;\n      overflow-y: auto;\n      grid-auto-flow: row;\n    }\n  }\n\n  &.hide-scrollbar {\n    .scroller {\n      -ms-overflow-style: none;  /* IE and Edge */\n      scrollbar-width: none;  /* Firefox */\n\n      &::-webkit-scrollbar {\n        display: none;\n      }\n    }\n  }\n}\n</style>\n"],"names":["DEFAULT_OPTIONS","useAutoplay","params","changeInterval","ref","getOptions","options","__name","startAutoplay","stopAutoplay","useScroll","scrollerElementRef","props","itemElementWidth","slidesKeys","firstVisibleSlideKey","visibleSlidesKeys","isScrollEnd","prevScrollPosition","isProgramScroll","mockSlides","visibleMockSlidesKeys","setOverflow","value","scrollToSlideByKey","slideKey","slideElement","detectVisibleMockSlides","slideElements","detectVisibleSlides","detectFirstVisibleSlide","useDebounceFn","middleIndex","isFirstSlideVisible","isLastSlideVisible","mockSlidesVisible","scrollTo","top","left","scroll","data","width","endWidth","nextTick","onScrollEvent","useLastSlideIntersection","copiedFirstRef","copiedFirstRefIntersection","registerRef","instance","startIntersection","useIntersectionObserver","isIntersecting","slides","stopIntersection","useMouseEvents","currentPosition","reactive","isFocused","onMouseMove","event","dx","dy","onMouseUp","onMouseDown","computed","_a","_b","slots","useSlots","nodes","child","slideStyles","carouselScroll","activeItemIndex","key","lastSlide","next","offset","previous","autoplay","mouseEvents","scrollerStyle","gridStyle","cursor","onMounted","onBeforeUnmount","expose"],"mappings":"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"}